if("undefined"==typeof scaaffCheck&&(scaaffCheck=!1),!scaaffCheck){var scaAppUrl,scaCdn,scaAwsUrl,scaAppEnv="production",[requiredConfirmTerm,termUrl]=[!1,null];function scaaff_is_installed(){for(var e=!1,t=document.getElementsByTagName("script"),r=0;r<t.length;++r){var o=t[r].getAttribute("src");if(t[r].innerText.indexOf("asyncLoad")>=0&&t[r].innerText.indexOf(scaGetScriptFileName())>=0||o&&o.indexOf("shop=")>=0&&o.indexOf(scaGetScriptFileName())>=0){console.log("already has scripttag, load AFF"),e=!0;break}}return e}function scaGetScriptFileName(){return{dev:"sca_affiliate_dev.js",test:"sca_affiliate_test.js",production:"sca_affiliate.js"}[scaAppEnv]||"sca_affiliate.js"}function scaSetDefaultUrl(){scaAppUrl={dev:"https://secomapp-affiliate.test",test:"https://af-test.uppromote.com",production:"https://track.uppromote.com"}[scaAppEnv]||"https://af.uppromote.com",scaCdn={dev:"https://secomapp-affiliate.test",test:"https://d1639lhkj5l89m.cloudfront.net",production:"https://d1639lhkj5l89m.cloudfront.net"}[scaAppEnv]||"https://d1639lhkj5l89m.cloudfront.net",scaAwsUrl={dev:"https://secomapp-affiliate.test",test:"https://af-test.uppromote.com",production:"https://cdn.uppromote.com"}[scaAppEnv]||"https://cdn.uppromote.com"}if(scaaff_is_installed()){function scaAssetS3(e){let t=scaAwsUrl;return e.startsWith("http")?e:("production"!==scaAppEnv&&(t=`${t}/storage`),`${t}/${e=(e=e.replace("//","/")).startsWith("/")?e.slice(1,e.length):e}`)}scaaffCheck=!0,scaSetDefaultUrl();var scaLoadScript=function(e,t){var r=document.createElement("script");r.type="text/javascript",r.readyState?r.onreadystatechange=function(){"loaded"!=r.readyState&&"complete"!=r.readyState||(r.onreadystatechange=null,t())}:r.onload=function(){t()},r.src=e,document.getElementsByTagName("head")[0].appendChild(r)};function scaParseQueryString(e){for(var t=e.split("&"),r={},o=0;o<t.length;o++){var a=t[o].split("="),s=decodeURIComponent(a[0]),n=decodeURIComponent(a[1]);if(void 0===r[s])r[s]=decodeURIComponent(n);else if("string"==typeof r[s]){var i=[r[s],decodeURIComponent(n)];r[s]=i}else r[s].push(decodeURIComponent(n))}return r}function scaSetCookieExpiredSecond(e,t,r){var o=new Date;o.setTime(o.getTime()+1e3*r);var a="expires="+o.toUTCString();document.cookie=e+"="+t+";"+a+";path=/"}function scaSetCookie(e,t,r){var o=new Date;o.setTime(o.getTime()+24*r*60*60*1e3);var a="expires="+o.toUTCString();document.cookie=e+"="+t+";"+a+";path=/"}function scaGetCookie(e){for(var t=e+"=",r=document.cookie.split(";"),o=0;o<r.length;o++){for(var a=r[o];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return"none"}function scaGetShopName(){var e=Shopify.shop.indexOf("myshopify.com");return Shopify.shop.substr(0,e-1)}function scaGenerateMessageBar(){if(!parseInt(scaAffCustomerRefer.getCookie("scaaf_is_program_customer"))&&"undefined"!=typeof SCAAFMessageBar&&1==SCAAFMessageBar.referral_enable){jQuerySCAAF(".scaaf-message-bar").length>0&&jQuerySCAAF(".scaaf-message-bar").remove();let e=null;"none"!==scaGetCookie("scaaf_afn")&&(e=scaGetCookie("scaaf_afn"));let t="Arial|Helvetica+Neue|Courier+New|Times+New+Roman|Comic+Sans+MS|Impact".split("|");if(null!=e){let r=null;"none"!==scaGetCookie("scaaf_afc")&&(r=scaGetCookie("scaaf_afc")),null!=r&&"null"!=r||(r="");let o=null;"none"!==scaGetCookie("scaaf_affn")&&(o=scaGetCookie("scaaf_affn")),null!=o&&"null"!=o||(o="");let a=null;if("none"!==scaGetCookie("scaaf_pd")&&(a=scaGetCookie("scaaf_pd")),null!=a&&"null"!=a||(a=""),null!=SCAAFMessageBar.referral_content&&""!=SCAAFMessageBar.referral_content){let s=SCAAFMessageBar.referral_font.replace(/\+/g," ");s=s.split(":"),-1==t.indexOf(SCAAFMessageBar.referral_font)&&jQuerySCAAF("head").append('<link href="https://fonts.googleapis.com/css?family='+SCAAFMessageBar.referral_font+'" rel="stylesheet" type="text/css">');let n='<div class="scaaf-message-bar" style="text-align: center;display: block;width: 100%;padding: 10px;background-color: '+SCAAFMessageBar.referral_background_color+';">\n    <p style="margin: 0;padding: 0;color: '+SCAAFMessageBar.referral_text_color+";font-size: "+SCAAFMessageBar.referral_font_size+"px;font-family: '"+s[0]+"', sans-serif\">"+SCAAFMessageBar.referral_content+"</p>\n  </div>";n=(n=(n=(n=n.replace("{affiliate_name}",e)).replace("{company}",r)).replace("{affiliate_firstname}",o)).replace("{personal_detail}",a),jQuerySCAAF("body").prepend(n)}}else if(1==SCAAFMessageBar.not_referral_enable&&null!=SCAAFMessageBar.not_referral_content&&""!=SCAAFMessageBar.not_referral_content){let e=SCAAFMessageBar.not_referral_font.replace(/\+/g," ");e=e.split(":"),-1==t.indexOf(SCAAFMessageBar.not_referral_font)&&jQuerySCAAF("head").append('<link href="https://fonts.googleapis.com/css?family='+SCAAFMessageBar.not_referral_font+'" rel="stylesheet" type="text/css">'),jQuerySCAAF("body").prepend('<div class="scaaf-message-bar" style="text-align: center;display: block;width: 100%;padding: 10px;background-color: '+SCAAFMessageBar.not_referral_background_color+';">\n    <p style="margin: 0;padding: 0;color: '+SCAAFMessageBar.not_referral_text_color+";font-size: "+SCAAFMessageBar.not_referral_font_size+"px;font-family: '"+e[0]+"', sans-serif\">"+SCAAFMessageBar.not_referral_content+"</p>\n  </div>")}}}function scaPostClickTracking(e,t){e.sca_source=localStorage.getItem("scaaf_sca_source_secomus")||void 0,jQuerySCAAF.ajax({type:"POST",async:!1,url:scaAppUrl+"/api/click_tracking",crossDomain:!0,data:e,dataType:"json",success:function(e){"ok"===e.status?(localStorage.setItem("scaaf_tid",e.tid),localStorage.setItem("scaaf_ep",1e3*e.ep),scaSetCookie("scaaf_tid",e.tid,360),scaSetCookie("scaaf_ep",1e3*e.ep,360),scaSetCookie("scaaf_afn",e.afd.affiliate_name,e.afcookie),scaSetCookie("scaaf_afc",e.afd.company,e.afcookie),scaSetCookie("scaaf_affn",e.afd.affiliate_firstname,e.afcookie),scaSetCookie("scaaf_pd",e.afd.personal_detail,e.afcookie),localStorage.setItem("scaaf_received","true"),scaGetCouponCode(!1),scaAffCustomerRefer.setCustomerReferralState(1,e.program_id)):(clearInterval(t),scaAffCustomerRefer.setCustomerReferralState(0,null))},error:function(e,r,o){console.warn(e,r,o),clearInterval(t),scaAffCustomerRefer.setCustomerReferralState(0,null)}})}function scaPostCartToken(e,t){e.ug=navigator.userAgent,e.sca_source=localStorage.getItem("scaaf_sca_source_secomus")||void 0,jQuerySCAAF.ajax({type:"POST",async:!1,url:scaAppUrl+"/api/ctk",crossDomain:!0,data:e,dataType:"json",success:function(r,o,a){"ok"==r.status?(scaSetCookie("scaaf_tid",r.tid,360),localStorage.setItem("scaaf_tid",r.tid),localStorage.setItem("scaaf_ctk",e.ctk),scaSetCookie("scaaf_ctk",e.ctk,360),localStorage.setItem("scaaf_received","true")):clearInterval(t)},error:function(e,r,o){console.warn(e,r,o),clearInterval(t)}})}function restoreLocalStorage(e,t,r,o,a){localStorage.setItem("scaaf_aid",e),localStorage.setItem("scaaf_tid",t),localStorage.setItem("scaaf_c_c",r),localStorage.setItem("scaaf_ctk",o),localStorage.setItem("scaaf_ep",a),"none"!=scaGetCookie("scaaf_sca_source_secomus")&&localStorage.setItem("scaaf_sca_source_secomus",scaGetCookie("scaaf_sca_source_secomus"))}function scaPostCheckoutToken(){let e={aid:localStorage.getItem("scaaf_aid"),ct_tk:Shopify.Checkout.token,s:shopName,hc:localStorage.getItem("scaaf_hc"),order_id:Shopify.checkout.order_id};e.sca_source=localStorage.getItem("scaaf_sca_source_secomus")||void 0,jQuerySCAAF.ajax({type:"POST",async:!1,url:scaAppUrl+"/api/ct_tk",crossDomain:!0,data:e,dataType:"json",success:function(e,t,r){e.status},error:function(e,t,r){console.warn(e,t,r)}})}function scaPostAffiliatePurchase(e){if(requiredConfirmTerm){if(!jQuerySCAAF("#confirm-term").prop("checked"))return jQuerySCAAF(e.target).css("cursor","not-allowed"),!1}var t=e.target;jQuerySCAAF(t).text("Loading...."),jQuerySCAAF(t).prop("disabled",!0);let r={email:Shopify.checkout.email,first_name:Shopify.checkout.billing_address.first_name,last_name:Shopify.checkout.billing_address.last_name,coupon:Shopify.checkout.discount?Shopify.checkout.discount.code:null,shop:Shopify.shop,affiliate_id:localStorage.getItem("scaaf_aid")||scaGetCookieByName("scaaf_aid")};jQuerySCAAF.ajax({type:"POST",async:!0,url:scaAppUrl+"/api/post_affiliate_purchase",crossDomain:!0,data:r,dataType:"json",beforeSend:function(){jQuerySCAAF(t).text("Loading....")},success:function(e){if("ok"===e.status){let t='<div class="result_wrapper" style="display: flex;padding:20px;"><div class="input-link-wrapper" style="flex-grow: 1;">';""!==e.coupon_code?t+='<input class="sca_ip" id="sca_referral_link_ip" style="border: 1px solid rgba(33,33,33,.12);color:#237392;font-weight:600;padding:10px;width:100%;" type="text" name="" value="'+e.coupon_code+'">':t+='<input class="sca_ip" id="sca_referral_link_ip" style="border: 1px solid rgba(33,33,33,.12);color:#237392;font-weight:600;padding:10px;width:100%;" type="text" name="" value="'+e.referral_link+'">',t+="</div>",""!==e.coupon_code?t+='<button class="sca_bt sca_btn_copy" id="sca_popup_copy_btn" onclick="scaCopy(\'sca_referral_link_ip\',\'sca_popup_copy_btn\',\'Copy coupon\')" style="margin-left: 15px;" >Copy coupon</button>':t+='<button class="sca_bt sca_btn_copy" id="sca_popup_copy_btn" onclick="scaCopy(\'sca_referral_link_ip\',\'sca_popup_copy_btn\',\'Copy link\')" style="margin-left: 15px;" >Copy link</button>',t+="</div>";let r='<a href="https://www.facebook.com/sharer.php?u='+e.referral_link+'" title="Share on Facebook" target="_blank"><img src="'+scaCdn+'/img/facebook.svg"></a><a href="https://twitter.com/intent/tweet?url='+e.referral_link+'" title="Share on Twitter" target="_blank"><img src="'+scaCdn+'/img/twitter.svg"></a><a href="http://pinterest.com/pin/create/link/?url='+e.referral_link+'" title="Share on Pinterest" target="_blank"><img src="'+scaCdn+'/img/pinterest.svg"></a><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url='+e.referral_link+'" title="Share on LinkedIn" target="_blank"><img src="'+scaCdn+'/img/linkedin.svg"></a>';jQuerySCAAF("#sca_result_wrapper").html(t),jQuerySCAAF("#sca_share").html(r),jQuerySCAAF("#sca_share").show()}},error:function(e,t,r){console.warn(e,t,r)}})}function scaShowPurchasePopup(e){let t=e.design,r=e.promotion_method,o=".sca_modal_overlay{z-index:1000;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);display:flex;justify-content:center;align-items:center}.sca_modal_container{background-color:#fff;max-height:100vh;margin-left:8px;margin-right:8px;border-radius:4px;overflow-y:auto;box-sizing:border-box}.sca_modal_header{display:flex;justify-content:space-between;align-items:center}.sca_modal_title{margin-top:0;margin-bottom:0;font-weight:600;font-size:1.25rem;line-height:1.25;color:#00449e;box-sizing:border-box}.sca_modal_close{background:0 0;border:0}.x-btn{font-size:18px}.modal_content{margin-top:2rem;margin-bottom:2rem;line-height:1.5;color:rgba(0,0,0,.8)}.modal_btn{font-size:.875rem;background-color:#e6e6e6;color:rgba(0,0,0,.8);border-radius:.25rem;border-style:none;border-width:0;cursor:pointer;-webkit-appearance:button;text-transform:none;overflow:visible;line-height:1.15;margin:0;will-change:transform;-moz-osx-font-smoothing:grayscale;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-transform:translateZ(0);transform:translateZ(0);transition:-webkit-transform .25s ease-out;transition:transform .25s ease-out;transition:transform .25s ease-out,-webkit-transform .25s ease-out;padding:.5rem 1rem}.modal_btn:focus,.modal_btn:hover{-webkit-transform:scale(1.05);transform:scale(1.05)}.modal_btn-primary{background-color:#00449e;color:#fff}@keyframes mmfadeIn{from{opacity:0}to{opacity:1}}@keyframes mmfadeOut{from{opacity:1}to{opacity:0}}@keyframes mmslideIn{from{transform:translateY(15%)}to{transform:translateY(0)}}@keyframes mmslideOut{from{transform:translateY(0)}to{transform:translateY(-10%)}}.sml{display:none}.sml.is-open{display:block}.sml[aria-hidden=false] .sca_modal_overlay{animation:mmfadeIn .3s cubic-bezier(0,0,.2,1)}.sml[aria-hidden=false] .sca_modal_container{animation:mmslideIn .3s cubic-bezier(0,0,.2,1)}.sml[aria-hidden=true] .sca_modal_overlay{animation:mmfadeOut .3s cubic-bezier(0,0,.2,1)}.sml[aria-hidden=true] .sca_modal_container{animation:mmslideOut .3s cubic-bezier(0,0,.2,1)}.sml .sca_modal_container,.sml .sca_modal_overlay{will-change:transform}#sca_main{text-align:center}#sca_content{max-width:400px;width:80%;display:inline-block;overflow:hidden}#sca_title{font-size:1.2rem;text-align:center;padding:16px 8px 2px}#sca_subtitle{font-size:.8rem;opacity:.9;text-align:center;padding:8px 4px}.x-btn{position:absolute;top:4px;right:8px;cursor: pointer;border-radius: 0.25rem;background-color: lightgray;padding:0px 6px 4px 6px;}#sca_share{padding:10px 0 12px;background-color:#efefef;text-align:center}#sca_share a{text-decoration:none;margin:4px;width:32px;height:32px;display:inline-block}#sca_share a:hover,#sca_share a:visited{text-decoration:none;margin:4px;width:32px;height:32px;display:inline-block}#sca_share img{width:28px;height:28px;margin:2px;transition:.1s}.sca_input_block_parent{margin:16px 4px}.sca_input_block{display:flex;border-radius:2px;border:1px solid #ced4da}.sca_input{border:transparent;background:0 0;outline:0;flex:1;padding:0 4px;opacity:.75;font-size:1rem}.sca_copy_button{background-color:#efefef;border-color:transparent;padding:4px;height:100%;min-width:60px;min-height:32px;font-size:1rem}.sca_copy_button:hover{background-color:#ddd}.input_label{font-weight:700;font-size:.8rem;display:inline-block;width:100%;margin:0;padding:0;text-align:left}#sca_reg_mode_manual_btn{font-size:1.2rem;display:inline-block;padding:.8rem 1rem;margin:1rem;text-decoration:none;box-shadow:0 0 12px #bbb}.sca_input-group{display:table;border-collapse:collapse;width:100%}.sca_input-group>div{display:table-cell;border:1px solid #ddd;vertical-align:middle}.sca_input-group-icon{background:#eee;color:#777;padding:0 12px}.sca_input-group-area{width:100%}.sca_input-group input{border:0;display:block;width:100%;padding:8px}.sca_ip{-webkit-writing-mode:horizontal-tb!important;text-rendering:auto;color:initial;letter-spacing:normal;word-spacing:normal;text-transform:none;text-indent:0;text-shadow:none;display:inline-block;text-align:start;-webkit-appearance:textfield;background-color:#fff;-webkit-rtl-ordering:logical;cursor:text;margin:0;font:400 13.3333px Arial;padding:1px 0;border-width:2px;border-style:inset;border-color:initial;border-image:initial}.sca_bt{-webkit-appearance:button;-webkit-writing-mode:horizontal-tb!important;text-rendering:auto;color:buttontext;letter-spacing:normal;word-spacing:normal;text-transform:none;text-indent:0;text-shadow:none;display:inline-block;text-align:center;align-items:flex-start;cursor:default;background-color:buttonface;box-sizing:border-box;margin:0;font:400 13.3333px Arial;padding:1px 6px;border-width:2px;border-style:outset;border-color:buttonface;border-image:initial}",a="",s=e.custom_css;requiredConfirmTerm&&(o+="#confirm-term{appearance: auto !important;-webkit-appearance: checkbox !important}",a=`\n                    <input type="checkbox" id="confirm-term" name="confirm-term" onchange="updateConfirmTermState(event)">\n                    <label for="confirm-term">\n                        I agree with <a href="${termUrl}" target="_blank">Terms and Conditions</a>\n                    </label>\n                    <br>`),jQuerySCAAF("head").append('<style type="text/css">'+o+s+"</style>");let n='<div id="sca_purchase_popup_modal_container"><div class="sml is-open" id="modal-1" aria-hidden="false"><div class="sca_modal_overlay" id="sca_modal_overlay" tabindex="-1" data-micromodal-close=""><div class="sca_modal_container" id="modal_container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title" style="max-width: '+t.image_width+'px; width: 90%;"><button class="sca_modal_close x-btn" aria-label="Close modal" data-micromodal-close="">x</button><div id="sca_popup"><div id="sca_img" style="background-image: url('+("none"===t.header_image?"https://af.uppromote.com/img/default_popup.jpg":scaAssetS3(t.header_image))+"); background-position: center center; background-repeat: no-repeat; background-size: cover; width: 100%; height: "+t.image_height+'px;"></div><div id="sca_main" style="display: block;"><div id="sca_content"><h2 id="sca_title" style="font-size:24px;color:'+t.title_color+';">'+t.title+"</h2>";2===r?(n+='<div id="sca_subtitle" style="color:'+t.subtitle_color+';">'+t.sub_title_coupon+"</div>",n+=a,n+=`<div id="sca_result_wrapper"><a onclick="scaPostAffiliatePurchase(event)" id="sca_reg_mode_manual_btn"  style="cursor: ${requiredConfirmTerm?"not-allowed":"pointer"};background-color: ${t.button_background}; color: ${t.button_text_color}; border-radius: ${t.button_border_radius}px;">${t.button_text_coupon}<div class="loader"></div></a></div>`):(n+='<div id="sca_subtitle" style="color:'+t.subtitle_color+';">'+t.sub_title+"</div>",n+=a,n+=`<div id="sca_result_wrapper"><a onclick="scaPostAffiliatePurchase(event)" id="sca_reg_mode_manual_btn"  style="cursor: ${requiredConfirmTerm?"not-allowed":"pointer"};background-color: ${t.button_background}; color: ${t.button_text_color}; border-radius: ${t.button_border_radius}px;">${t.button_text}<div class="loader"></div></a></div>`),n+='</div></div><div id="sca_share" style="display:none"></div></div></div></div></div></div>',jQuerySCAAF("body").append(n)}function updateConfirmTermState(e){const t=jQuerySCAAF(e.target).prop("checked");jQuerySCAAF("#sca_reg_mode_manual_btn").css("cursor",t?"pointer":"not-allowed")}function scaCopyToClipboard(e){if(e="string"==typeof e?document.querySelector(e):e,navigator.userAgent.match(/ipad|ipod|iphone/i)){var t=e.contentEditable,r=e.readOnly;e.contentEditable=!0,e.readOnly=!0;var o=document.createRange();o.selectNodeContents(e);var a=window.getSelection();a.removeAllRanges(),a.addRange(o),e.setSelectionRange(0,999999),e.contentEditable=t,e.readOnly=r}else e.select();document.execCommand("copy")}function scaCopy(e,t,r){var o=document.getElementById(e),a=document.getElementById(t);scaCopyToClipboard(o),a.innerHTML="Copied",setTimeout(function(){a.innerHTML=r},1e3)}var shopName=scaGetShopName();function scaGetCouponCode(e){"none"!==scaGetCookie("scaaf_aid")&&jQuerySCAAF.ajax({type:"GET",url:scaAppUrl+"/api/get_coupon",async:!1,crossDomain:!0,data:{aid:scaGetCookie("scaaf_aid")},dataType:"json",success:function(t,r,o){if("ok"==t.status){var a=t.coupon,s=encodeURI("/discount/"+a);s=s.replace("#","%2523"),jQuerySCAAF("body").prepend('<iframe src="'+s+'" height=0 width=0 frameborder=0 marginheight=0 marginwidth=0 scrolling=no onload="scroll(0,0);" style="display: none"></iframe>'),!1!==e&&(window.location.href=e+"&discount="+a)}else!1!==e&&(window.location.href=e)},error:function(t){!1!==e&&(window.location.href=e)},fail:function(t,r,o){!1!==e&&(window.location.href=e)}})}function scaTrackFbPixel(){var e=scaGetCookie("scaaf_aid"),t=Shopify.shop;console.log(e),"none"!==e&&t&&jQuerySCAAF.ajax({type:"GET",url:scaAppUrl+"/api/get_fb_pixel",crossDomain:!0,data:{aff_id:scaGetCookie("scaaf_aid"),shop:t},dataType:"json",success:function(e,t,r){if("ok"==e.status){var o=e.fb_pixel;fbq("init",o),fbq("trackSingle",o,"PageView"),"undefined"!=typeof Shopify&&Shopify.checkout&&fbq("trackSingle",o,"Purchase",{value:Shopify.checkout.total_price,currency:Shopify.checkout.currency}),"undefined"!=typeof Shopify&&Shopify.Checkout&&"contact_information"===Shopify.Checkout.step&&fbq("trackSingle",o,"InitiateCheckout",{currency:Shopify.checkout.currency,value:Shopify.checkout.estimatedPrice}),document.location.pathname.startsWith("/cart")&&fbq("trackSingle",o,"AddToCart")}}})}function appendAffiliateIdToRegForm(){if("register"===(window.location.pathname.split("/")[2]||null)){const e=localStorage.getItem("scaaf_aid");if(e){const t=document.querySelector('form[method="post"][action*="account"]');if(t){const r=document.createElement("input");r.setAttribute("type","hidden"),r.setAttribute("name","customer[note][affiliate_id]"),r.value=e,t.append(r)}}}}function scaGetCookieByName(e){const t=`; ${document.cookie}`.split(`; ${e}=`);return 2===t.length?t.pop().split(";").shift():null}scaLoadScript("//code.jquery.com/jquery-3.0.0.min.js",function(){jQuerySCAAF=jQuery.noConflict(!0),jQuerySCAAF.ajaxSetup({data:{shopify_domain:Shopify.shop}});var e=scaParseQueryString(window.location.search.substring(1)),t=localStorage.getItem("scaaf_tid"),r=(scaGetCookie("tracked_start_checkout"),navigator.userAgent);if(void 0!==e.sca_ref){var o=e.sca_ref.split("."),a={aid:o[0],hc:o[1],s:shopName,tid:t,ug:r},s=localStorage.getItem("scaaf_c_c"),n=(new Date).getTime();localStorage.setItem("scaaf_received","false"),localStorage.setItem("scaaf_aid",a.aid),localStorage.setItem("scaaf_hc",a.hc),localStorage.setItem("scaaf_c_c",n),void 0!==e.sca_source?(localStorage.setItem("scaaf_sca_source_secomus",e.sca_source),scaSetCookie("scaaf_sca_source_secomus",e.sca_source,360)):(localStorage.setItem("scaaf_sca_source_secomus",""),scaSetCookie("scaaf_sca_source_secomus","",360)),scaSetCookie("scaaf_aid",a.aid,360),scaSetCookie("scaaf_c_c",n,360),null==s?scaPostClickTracking(a):n-s>6e4&&scaPostClickTracking(a),void 0!==e.sca_rib&&("none"!==scaGetCookie("scaaf_aid")?scaGetCouponCode(e.sca_rib):window.location.href=e.sca_rib)}scaGetCouponCode(!1),scaAffCustomerRefer.waitForSetting(scaGenerateMessageBar,scaGenerateMessageBar),null!=localStorage.getItem("scaaf_aid")&&Shopify.Checkout&&Shopify.Checkout.token&&localStorage.getItem("scaaf_ep")>(new Date).getTime()&&scaPostCheckoutToken();var i,c,f,l,u,d,p=setInterval(function(){var e=localStorage.getItem("scaaf_ctk"),t=scaGetCookie("cart");if("none"!==t){if(null!=localStorage.getItem("scaaf_tid")&&null!=localStorage.getItem("scaaf_aid")){var o=localStorage.getItem("scaaf_ep");if(null!=o&&o<(new Date).getTime())return clearInterval(p),"";if(t!=e)scaPostCartToken({aid:localStorage.getItem("scaaf_aid"),tid:localStorage.getItem("scaaf_tid"),ctk:t,s:shopName},p)}else{var a=scaGetCookie("scaaf_tid"),s=scaGetCookie("scaaf_aid");if("none"!==a&&"none"!==s){var n=scaGetCookie("scaaf_ctk");restoreLocalStorage(s,a,scaGetCookie("scaaf_c_c"),n,scaGetCookie("scaaf_ep"))}}if("false"==localStorage.getItem("scaaf_received"))scaPostClickTracking({aid:localStorage.getItem("scaaf_aid"),hc:localStorage.getItem("scaaf_hc"),s:shopName,tid:localStorage.getItem("scaaf_tid"),ug:r},p)}},1e3);Shopify.Checkout&&Shopify.checkout.email&&(jQuerySCAAF.ajax({type:"GET",url:scaAppUrl+"/api/purchase_popup/setting",crossDomain:!0,data:{shop:Shopify.shop,email:Shopify.checkout.email},dataType:"json",success:function(e,t,r){if("ok"===e.status){let t=e.settings;e.customize&&(requiredConfirmTerm=!0,termUrl=e.customize.term),"none"!=scaGetCookie("sca_p_p_show_once")&&0!=t.show_only_once||(scaShowPurchasePopup(t),1==t.close_background_click&&(window.onclick=function(e){var t=document.getElementById("sca_modal_overlay");e.target==t&&(t.style.display="none")}),1==t.show_only_once&&scaSetCookie("sca_p_p_show_once",1,365))}},error:function(e,t,r){console.warn(e,t,r)}}),jQuerySCAAF(document).on("click",".sca_modal_close",function(){jQuerySCAAF("#sca_purchase_popup_modal_container").hide()})),i=window,c=document,f="script",i.fbq||(l=i.fbq=function(){l.callMethod?l.callMethod.apply(l,arguments):l.queue.push(arguments)},i._fbq||(i._fbq=l),l.push=l,l.loaded=!0,l.version="2.0",l.queue=[],(u=c.createElement(f)).async=!0,u.src="https://connect.facebook.net/en_US/fbevents.js",(d=c.getElementsByTagName(f)[0]).parentNode.insertBefore(u,d)),scaTrackFbPixel(),appendAffiliateIdToRegForm()})}}if("undefined"==typeof SCAAFFCustomerRefer){class e{constructor(){this.host="https://af.uppromote.com",this.setting=null,this.referContainer=null,this.referIcon=null,this.inviteContainer=null,this.inviteContentContainer=null,this.errorText=null,this.closeButton=null,this.inviteEmailInput=null,this.getInviteLinkButton=null,this.closeShopNowButton=null,this.shopNowContainer=null,this.shopNowOverlayContainer=null,this.uiComponents={}}init(){const e=setInterval(()=>{"undefined"!=typeof SCAAFFCustomerReferSetting&&"undefined"!=typeof jQuerySCAAF&&(clearInterval(e),scaAffCustomerRefer.setting=SCAAFFCustomerReferSetting,scaAffCustomerRefer.setting.program.active&&(this.renderReferCustomer(),this.addEventListener(),this.checkRegisterStatus()))},500);setTimeout(()=>{clearInterval(e)},1e4)}addEventListener(){scaAffCustomerRefer.referIcon.addEventListener("click",scaAffCustomerRefer.onReferButtonClicked),scaAffCustomerRefer.closeButton.addEventListener("click",scaAffCustomerRefer.onReferButtonClicked),scaAffCustomerRefer.getInviteLinkButton.addEventListener("click",scaAffCustomerRefer.submitRegister)}addShopNowPopupEventListener(){scaAffCustomerRefer.closeShopNowButton&&(scaAffCustomerRefer.closeShopNowButton.addEventListener("click",function(e){scaAffCustomerRefer.onCloseShopNowButtonClicked(e)}),scaAffCustomerRefer.shopNowOverlayContainer.addEventListener("click",function(e){scaAffCustomerRefer.onCloseShopNowButtonClicked(e)}),scaAffCustomerRefer.uiComponents.shopNowButton.addEventListener("click",function(e){scaAffCustomerRefer.onCloseShopNowButtonClicked(e)}))}checkRegisterStatus(){const e=scaAffCustomerRefer.getCookie("scaaf_refer_customer_link");e&&(scaAffCustomerRefer.applyInviteLink(e),scaAffCustomerRefer.setRegisterState(e))}renderReferCustomer(){const e=scaAffCustomerRefer.renderCustomerReferContainer(),t=scaAffCustomerRefer.renderReferIcon(),r=scaAffCustomerRefer.renderInviteContainer(),o=scaAffCustomerRefer.renderCloseButton(),a=scaAffCustomerRefer.renderInviteContentContainer(),s=scaAffCustomerRefer.renderInviteHeader(),n=scaAffCustomerRefer.renderInviteContent(),i=scaAffCustomerRefer.renderInviteInputContainer(),c=scaAffCustomerRefer.renderInviteInput(),f=scaAffCustomerRefer.renderInviteInputAddon(),l=scaAffCustomerRefer.renderErrorContainer();i.append(f,c),a.append(s,n,i,l),r.append(o,a),e.append(r,t),document.body.append(e)}renderShopNowPopup(){const e=this.renderShopNowOverlay(),t=this.renderShopNowContainer(),r=this.renderCloseShopNowButton(),o=this.renderShopNowHeader(),a=this.renderShopNowContent(),s=this.renderShopNowButton();scaAffCustomerRefer.uiComponents.shopNowButton=s,t.append(r,o,a,s),e.append(t),document.body.append(e)}onReferButtonClicked(){let e="fadeInUp",t="fadeOutDown";const r=scaAffCustomerRefer.referContainer.dataset.webPosition;"none"===getComputedStyle(scaAffCustomerRefer.inviteContainer).display?(r.includes("-bottom")&&(e="fadeInUp"),(r.includes("-center")||r.includes("-top"))&&(e="fadeInDown"),scaAffCustomerRefer.inviteContainer.style.animationName=e,setTimeout(()=>{scaAffCustomerRefer.inviteContainer.style.display="block"},100)):(r.includes("-bottom")&&(t="fadeOutDown"),(r.includes("-center")||r.includes("-top"))&&(t="fadeOutUp"),scaAffCustomerRefer.inviteContainer.style.animationName=t,setTimeout(()=>{scaAffCustomerRefer.inviteContainer.style.display="none"},500))}onCloseShopNowButtonClicked(e){const t=e.target.classList;(t.contains("sca_aff_customer_refer_shop_now_overlay")||t.contains("sca_aff_customer_refer_close_shop_now_button")||t.contains("sca_aff_customer_refer_shop_now_button"))&&(scaAffCustomerRefer.shopNowContainer.style.animationName="fadeOutUp",scaAffCustomerRefer.shopNowOverlayContainer.style.animationName="fadeOut",setTimeout(()=>{scaAffCustomerRefer.shopNowOverlayContainer.style.display="none"},500))}submitRegister(){if(this.hasAttribute("data-created-affiliate"))scaAffCustomerRefer.copyInviteLink();else{const e=scaAffCustomerRefer.inviteEmailInput.value;if(!scaAffCustomerRefer.isValidEmail(e))return scaAffCustomerRefer.errorText.textContent="Please enter a valid email address",void(scaAffCustomerRefer.errorText.style.display="block");scaAffCustomerRefer.setRegisteringStateButton(),scaAffCustomerRefer.postRegister(e)}}postRegister(e){const t=scaAffCustomerRefer.setting.program.shop;jQuerySCAAF.ajax(`${scaAffCustomerRefer.host}/api/refer-customer/register`,{method:"POST",dataType:"JSON",data:{email:e,shop:t},crossDomain:!0,success:function(e){scaAffCustomerRefer.errorText.style.display="none",e.error?(scaAffCustomerRefer.errorText.textContent=e.error,scaAffCustomerRefer.errorText.style.display="block"):(scaAffCustomerRefer.applyInviteLink(e.data),scaAffCustomerRefer.setRegisterState(e.data))},complete:function(){scaAffCustomerRefer.setRegisteringStateButton(!1)}})}processCustomerReferLink(){scaAffCustomerRefer.setting.program.active&&scaAffCustomerRefer.isCustomerReferLink()&&(scaAffCustomerRefer.renderShopNowPopup(),scaAffCustomerRefer.addShopNowPopupEventListener(),scaAffCustomerRefer.applyDiscountCode())}isValidEmail(e){return/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(e)}setRegisterState(e){scaAffCustomerRefer.setCookie("scaaf_refer_customer_link",e,365)}setCookie(e,t,r){const o=new Date;o.setTime(o.getTime()+24*r*60*60*1e3);let a="expires="+o.toUTCString();document.cookie=e+"="+t+";"+a+";path=/"}getCookie(e){let t=e+"=",r=decodeURIComponent(document.cookie).split(";");for(let e=0;e<r.length;e++){let o=r[e];for(;" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""}isCustomerReferLink(){try{const e=window.location.search,t=new URLSearchParams(e);let r=!1;return t.get("sca_ref")&&t.get("sca_crp")&&parseInt(atob(this.setting.program.program))===parseInt(atob(t.get("sca_crp")))&&(r=!0),r}catch(e){return console.error("Cant base64 decode customer refer program id"),!1}}setCustomerReferralState(e,t){scaAffCustomerRefer.waitForSetting(()=>{try{parseInt(t)===parseInt(atob(scaAffCustomerRefer.setting.program.program))?(e&&scaAffCustomerRefer.processCustomerReferLink(),scaAffCustomerRefer.setCookie("scaaf_is_program_customer",1,30)):(e&&scaGenerateMessageBar(),scaAffCustomerRefer.setCookie("scaaf_is_program_customer",0,30))}catch(e){console.error(e)}},()=>{e&&scaGenerateMessageBar(),scaAffCustomerRefer.setCookie("scaaf_is_program_customer",0,30)})}waitForSetting(e,t){let r=!1;const o=setInterval(()=>{scaAffCustomerRefer.setting&&(clearInterval(o),e(),r=!0)},200);setTimeout(()=>{clearInterval(o),!r&&t&&t()},5e3)}setRegisteringStateButton(e=!0){e?(scaAffCustomerRefer.getInviteLinkButton.setAttribute("disabled",""),scaAffCustomerRefer.getInviteLinkButton.style.cursor="wait",scaAffCustomerRefer.inviteEmailInput.setAttribute("disabled","")):(scaAffCustomerRefer.getInviteLinkButton.removeAttribute("disabled"),scaAffCustomerRefer.getInviteLinkButton.style.cursor="pointer",scaAffCustomerRefer.inviteEmailInput.removeAttribute("disabled"))}applyInviteLink(e){scaAffCustomerRefer.getInviteLinkButton.removeAttribute("disabled"),scaAffCustomerRefer.getInviteLinkButton.setAttribute("data-created-affiliate","true"),scaAffCustomerRefer.getInviteLinkButton.textContent=scaAffCustomerRefer.setting.design.refer_customer_invite.button_copy_invite,scaAffCustomerRefer.inviteEmailInput.type="text",scaAffCustomerRefer.inviteEmailInput.value=e,scaAffCustomerRefer.inviteEmailInput.setAttribute("readonly",""),scaAffCustomerRefer.inviteContentContainer.append(this.renderShareContainer(e))}copyInviteLink(){scaAffCustomerRefer.inviteEmailInput.focus(),scaAffCustomerRefer.inviteEmailInput.select(),navigator.clipboard.writeText(scaAffCustomerRefer.inviteEmailInput.value).then(()=>{scaAffCustomerRefer.getInviteLinkButton.textContent="Copied!",setTimeout(()=>{scaAffCustomerRefer.getInviteLinkButton.textContent=scaAffCustomerRefer.setting.design.refer_customer_invite.button_copy_invite},1e3)})}renderElm(e="div",t,r={}){const o=document.createElement(e);return t&&(Array.isArray(t)?t.map(e=>o.classList.add(e)):t&&0!==t.length&&o.classList.add(t)),Object.keys(r).forEach(e=>o.setAttribute(e,r[e])),o}renderCustomerReferContainer(){return this.referContainer=scaAffCustomerRefer.renderElm("div","sca_aff_customer_refer_container",{"data-web-position":scaAffCustomerRefer.setting.design.refer_customer_button.web_position,"data-mobile-position":scaAffCustomerRefer.setting.design.refer_customer_button.mobile_position}),this.referContainer}renderReferIcon(){const e=scaAffCustomerRefer.renderElm("button","sca_aff_customer_refer_button");scaAffCustomerRefer.referIcon=e;const t=scaAffCustomerRefer.renderElm("img",["sca_aff_customer_refer_icon"],{src:"https://cdn.uppromote.com/storage/feature-banner/gift.svg"});return e.textContent=scaAffCustomerRefer.setting.design.refer_customer_button.refer_button_text,e.style.backgroundColor=scaAffCustomerRefer.setting.design.refer_customer_button.refer_background_color,e.style.color=scaAffCustomerRefer.setting.design.refer_customer_button.refer_text_color,e.prepend(t),e}renderInviteContainer(){const e=scaAffCustomerRefer.renderElm("div","sca_aff_customer_refer_invite_container");return scaAffCustomerRefer.inviteContainer=e,e}renderCloseButton(){const e=scaAffCustomerRefer.renderElm("button","sca_aff_customer_refer_close_button",{type:"button"});return e.innerHTML="&times;",scaAffCustomerRefer.closeButton=e,e}renderInviteContentContainer(){const e=scaAffCustomerRefer.renderElm("div","sca_aff_customer_refer_invite_contents");return this.inviteContentContainer=e,e}renderInviteHeader(){const e=scaAffCustomerRefer.renderElm("h1","sca_aff_customer_refer_invite_header");return e.textContent=scaAffCustomerRefer.setting.design.refer_customer_invite.popup_header,e}renderInviteContent(){const e=scaAffCustomerRefer.renderElm("div","sca_aff_customer_refer_invite_content");return e.textContent=scaAffCustomerRefer.setting.design.refer_customer_invite.popup_description,e}renderInviteInputContainer(){return scaAffCustomerRefer.renderElm("div","sca_aff_custom_invite_inputs")}renderInviteInputAddon(){const e=scaAffCustomerRefer.renderElm("input","sca_aff_custom_invite_input",{type:"email",name:"sca_customer_refer_email",id:"sca_customer_refer_email",placeholder:"Your email address"});return scaAffCustomerRefer.inviteEmailInput=e,e}renderErrorContainer(){const e=this.renderElm("p","sca_aff_customer_invite_error");return this.errorText=e,e}renderShareContainer(e){e=encodeURIComponent(e);const t=this.renderElm("div","sca_aff_customer_invite_share_container"),r=this.renderElm("a",null,{href:`https://facebook.com/sharer/sharer.php?u=${e}`,target:"_blank"}),o=this.renderElm("img",null,{src:"https://cdn.uppromote.com/storage/uploads/icons/facebook.svg",alt:"facebook"}),a=this.renderElm("a",null,{href:`https://twitter.com/intent/tweet/?text=&url=${e}`,target:"_blank"}),s=this.renderElm("img",null,{src:"https://cdn.uppromote.com/storage/uploads/icons/twitter.svg",alt:"twitter"}),n=this.renderElm("a",null,{href:`https://pinterest.com/pin/create/button/?url=${e}`,target:"_blank"}),i=this.renderElm("img",null,{src:"https://cdn.uppromote.com/storage/uploads/icons/pinterest.svg",alt:"pinterest"}),c=this.renderElm("a",null,{href:`https://www.linkedin.com/shareArticle?mini=true&url=${e}&title=&summary=&source=${e}`,target:"_blank"}),f=this.renderElm("img",null,{src:"https://cdn.uppromote.com/storage/uploads/icons/linkedin.svg",alt:"linkedin"}),l=this.renderElm("a",null,{href:`https://reddit.com/submit/?url=${e}`,target:"_blank"}),u=this.renderElm("img",null,{src:"https://cdn.uppromote.com/storage/uploads/icons/reddit.svg",alt:"reddit"}),d=this.renderElm("a",null,{href:`mailto:?subject=&body=${e}`,target:"_blank"}),p=this.renderElm("img",null,{src:"https://cdn.uppromote.com/storage/uploads/icons/mail.svg",alt:"mail"});return r.append(o),a.append(s),n.append(i),c.append(f),l.append(u),d.append(p),t.append(r,a,n,c,l,d),t}renderInviteInput(){const e=scaAffCustomerRefer.renderElm("button","sca_aff_customer_refer_invite_button");return e.textContent=scaAffCustomerRefer.setting.design.refer_customer_invite.button_text_get_invite,e.style.backgroundColor=scaAffCustomerRefer.setting.design.refer_customer_invite.popup_background_color,e.style.color=scaAffCustomerRefer.setting.design.refer_customer_invite.popup_text_color,scaAffCustomerRefer.getInviteLinkButton=e,e}applyDiscountCode(){if("none"!==scaAffCustomerRefer.setting.program.incentive.type){const e=this.renderElm("iframe","sca_aff_customer_refer_discount_iframe"),t=scaAffCustomerRefer.setting.program.incentive.coupon;e.src=`/discount/${t}`,document.body.append(e)}}renderShopNowOverlay(){const e=this.renderElm("div","sca_aff_customer_refer_shop_now_overlay");return this.shopNowOverlayContainer=e,e}renderShopNowContainer(){const e=this.renderElm("div","sca_aff_customer_refer_shop_now_container");return this.shopNowContainer=e,e}renderCloseShopNowButton(){const e=scaAffCustomerRefer.renderElm("button","sca_aff_customer_refer_close_shop_now_button",{type:"button"});return e.innerHTML="&times;",scaAffCustomerRefer.closeShopNowButton=e,e}renderShopNowHeader(){const e=scaAffCustomerRefer.renderElm("h2","sca_aff_customer_refer_shop_now_header");return e.textContent=scaAffCustomerRefer.setting.design.refer_customer_incentive_popup.shop_header,e}renderShopNowContent(){const e=scaAffCustomerRefer.renderElm("div","sca_aff_customer_refer_shop_now_content");return e.textContent=scaAffCustomerRefer.setting.design.refer_customer_incentive_popup.shop_description,e}renderShopNowButton(){const e=scaAffCustomerRefer.renderElm("a","sca_aff_customer_refer_shop_now_button",{href:"#"});return e.innerHTML=scaAffCustomerRefer.setting.design.refer_customer_incentive_popup.shop_button_text,e.style.backgroundColor=scaAffCustomerRefer.setting.design.refer_customer_incentive_popup.shop_background_color,e.style.color=scaAffCustomerRefer.setting.design.refer_customer_incentive_popup.shop_text_color,scaAffCustomerRefer.shopNowButton=e,e}}if(void 0===scaAffCustomerRefer){var scaAffCustomerRefer=new e;scaAffCustomerRefer.init()}}